{"componentChunkName":"component---node-modules-nehalist-gatsby-theme-nehalem-src-templates-post-tsx","path":"/module-augmentation","result":{"data":{"post":{"id":"6c1117db-9a89-5ff2-b4db-0b8cc22ccc3e","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"Module Augmentation","path":"/module-augmentation","tags":["TypeScript"],"excerpt":"Module Augmentation giúp chúng ta mở rộng chức năng của một thư viện (3rd party libraries) cái mà chúng ta không có quyền truy cập để chỉnh sửa trực tiếp.","created":"2025-03-18T00:00:00.000Z","createdPretty":"18 March, 2025","updated":"2025-03-18T00:00:00.000Z","updatedPretty":"18 March, 2025","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAUDBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABsZdBxHWE/wD/xAAZEAACAwEAAAAAAAAAAAAAAAABAgARICL/2gAIAQEAAQUCUVD2pRhj/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8BV//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAAhASAx/9oACAEBAAY/AidE6f/EABwQAAICAgMAAAAAAAAAAAAAAAABESExQVFhkf/aAAgBAQABPyHWxwyC2KqxhFBBHb9IS0f/2gAMAwEAAgADAAAAEGvP/8QAFhEBAQEAAAAAAAAAAAAAAAAAEQEQ/9oACAEDAQE/EGrj/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EAAyy//EABkQAQEBAQEBAAAAAAAAAAAAAAERACFBcf/aAAgBAQABPxAz2jvStxE09ABU9Mhh4PMhJ0+M025FkBWsN//Z","aspectRatio":1.5037593984962405,"src":"/static/4df8cb1c937771363ae11677220bf858/f2cbb/cover.jpg","srcSet":"/static/4df8cb1c937771363ae11677220bf858/8850c/cover.jpg 200w,\n/static/4df8cb1c937771363ae11677220bf858/da113/cover.jpg 400w,\n/static/4df8cb1c937771363ae11677220bf858/f2cbb/cover.jpg 800w,\n/static/4df8cb1c937771363ae11677220bf858/c26c2/cover.jpg 1200w,\n/static/4df8cb1c937771363ae11677220bf858/9352a/cover.jpg 1600w,\n/static/4df8cb1c937771363ae11677220bf858/7700f/cover.jpg 6240w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"html":"<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>Dạo gần đây mình chủ yếu làm việc với leaflet, một thư viện js về bản đồ, và mình luôn có nhu cầu mở rộng các chức năng của thư viện này ra.\nVí dụ mình muốn thêm thuộc tính và phương thức mới vào một <strong>base</strong> class có sẵn của thư viện leaflet. Và vì là base class\n(class này đã được sử dụng ở nhiều nơi và ta cũng không có quyền truy cập để chỉnh sửa trực tiếp) nên ta không thể giải quyết được bằng\nphương cách kế thừa thông qua từ khóa extends. Và chức năng mình gọi nôm na là tăng cường module (module augmentation) của TypeScript\nlà cứu cánh của mình lúc ấy.\nTrước khi đi sâu vào module augmentation mình sẽ nói về 1 chức năng cơ bản hơn của TypeScript đó chính là declaration merging.</p>\n<h2 id=\"declaration-merging\" style=\"position:relative;\"><a href=\"#declaration-merging\" aria-label=\"declaration merging permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Declaration Merging</h2>\n<p>TypeScript cho phép ta merge interface với interface:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">interface Box {\n  height: number;\n  width: number;\n}\ninterface Box {\n  scale: number;\n}\nlet box: Box = { height: 5, width: 6, scale: 10 };</code></pre></div>\n<p>Ngoài ra ta còn có thể merge interface với class:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">class Food {\n  cheese: string;\n}\ninterface Food {\n  bacon: string;\n}\nconst food  = new Food();\nfood.bacon = \"nice bacon\";\nfood.cheese = \"sweet cheese\";\nconsole.log(food); // {bacon: \"nice bacon\", cheese: \"sweet cheese\"}</code></pre></div>\n<p>Tuy nhiên trong trường hợp interface của ta có chứa phương thức thì sẽ ra sao:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">class Food {\n  cheese: string;\n}\ninterface Food {\n  bacon: string;\n  bake(item: string);\n}\nconst food  = new Food();\nfood.bake(\"cake\"); // Error: food.bake is not a function</code></pre></div>\n<p>Bởi vì interface của ta chỉ có thể chứa khai báo cho phương thức chứ chưa có phần implementation của phương thức nên ta chưa thể sử dụng nó. Ta có thể implement thông qua\nprototype của js như sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Food.prototype.bake = (item) => console.log(item);</code></pre></div>\n<h2 id=\"module-augmentation\" style=\"position:relative;\"><a href=\"#module-augmentation\" aria-label=\"module augmentation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Module Augmentation</h2>\n<p>Module Augmentation giúp chúng ta mở rộng chức năng của một thư viện (3rd party libraries) cái mà chúng ta không có quyền truy cập để chỉnh sửa trực tiếp.\nQuay trở lại với vấn đề với leaflet mà mình đã đề cập ở đầu bài. Mình sẽ sử dụng chức năng module augmentation để thêm thuộc tính zIndex và phương thức\nsetZIndex vào class Path của thư viện leaflet như sau:<br>\nĐầu tiên ta import class Path từ thư viện leaflet:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import { Path } from 'leaflet';</code></pre></div>\n<p>Sau đó ta dùng từ khóa declare module với tên trùng với tên của leaflet module và interface với tên trùng với tên của class Path mà ta đang muốn mở rộng:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">declare module 'leaflet' {\n  interface Path {\n    zIndex?: number;\n    setZIndex(zIndex: number): this;\n  }\n}</code></pre></div>\n<p>Và sau cùng là thêm phần implementation cho phương thức setZIndex của ta:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Path.prototype.setZIndex = (zIndex) => console.log(zIndex);</code></pre></div>\n<p>Đến đây bạn đọc có thể sẽ thắc mắc tại sao ta không dùng class để merge cho dễ vì trong class ta có thể khai báo phương thức và cả phần implementation cho phương thức ấy.\nLý do chính là TypeScript không cho phép ta merge giữa class với class. Tuy nhiên TypeScript vẫn có cung cấp cho ta 1 giải pháp mô phỏng việc này đó chính là mixins\nvà đó cũng sẽ là chủ đề cho bài viết tiếp theo của mình.<br>\nHãy cùng thảo luận bên dưới comment bạn nhé - Sound off on the comment...</p>\n<h2 id=\"tài-liệu-tham-khảo\" style=\"position:relative;\"><a href=\"#t%C3%A0i-li%E1%BB%87u-tham-kh%E1%BA%A3o\" aria-label=\"tài liệu tham khảo permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tài liệu tham khảo</h2>\n<ul>\n<li><a href=\"https://www.typescriptlang.org/docs/handbook/declaration-merging.html\">Declaration Merging - TypeScript</a></li>\n<li><a href=\"https://www.digitalocean.com/community/tutorials/typescript-module-augmentation\">Module Augmentation in TypeScript</a></li>\n</ul>"},"primaryTag":{"name":"TypeScript","color":"#007acc"}},"pageContext":{"postId":"6c1117db-9a89-5ff2-b4db-0b8cc22ccc3e","primaryTag":"TypeScript"}},"staticQueryHashes":["1116962356","1568356344","2275848304","545095672","58735974"]}